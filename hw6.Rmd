---
title: "Homework 6"
author: "Vincent Tam"
date: "November 25, 2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr, purrr, ggplot)
hom_data <- read.csv(url("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"))
hom_data = 
  hom_data %>%
  mutate(city_state = str_c(city, ",", state)) %>%
  filter(city_state != "Dallas, TX", city_state != "Phoenix, AZ", city_state != "Kansas City, MO", city_state != "Tulsa, AL") %>% 
  mutate(victim_race = recode(victim_race, 'White' = "White", 'Hispanic' = "Non_white", 'Other' = "Non_white", 'Black' = "Non_white", 'Asian' = "Non_white", 'Unknown' = "Non_white")) %>% 
  mutate(solved = as.numeric(disposition == "Closed by arrest"),
         victim_age = as.numeric(victim_age),
         victim_race = fct_relevel(victim_race, "White", "Non_white")) %>% 
  mutate(victim_age = as.numeric(victim_age)) %>%
  group_by(city_state)
## For the city of Baltimore, MD, use the glm function to fit a logistic regression with resolved vs unresolved as the outcome and victim age, sex and race (as just defined) as predictors.
baltimore_data = 
  hom_data %>%
  filter(city_state == "Baltimore,MD")
baltimore_data
fit_logistic = 
  baltimore_data %>% 
  glm(solved ~ victim_age + victim_race + victim_sex, data = ., family = binomial()) 
fit_logistic %>% 
  broom::tidy() %>% 
  mutate(OR = boot::inv.logit(estimate)) %>%
    knitr::kable(digits = 3)
```
